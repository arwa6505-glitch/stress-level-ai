<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Stress Level Detection AI</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
:root{
  --accent:#ff7fa5;
  --accent-hover:#ff5c8f;
  --bg:#fff6fa;
  --card:#ffffff;
  --border:#ffd6e4;
  --text:#3a2a2f;
  --muted:#6b4b55;
}

*{box-sizing:border-box;}

body{
  margin:0;
  font-family:'Poppins',sans-serif;
  background:var(--bg);
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
  text-align:center;
  padding:20px;
}

.wrapper{max-width:700px;width:100%;}

h1{color:var(--accent);margin-bottom:20px;}

.container{
  background:var(--card);
  padding:30px;
  border-radius:25px;
  border:1px solid var(--border);
}

textarea{
  width:100%;
  height:150px;
  padding:15px;
  border-radius:20px;
  border:2px solid var(--border);
  font-size:16px;
  resize:none;
}

button{
  margin:15px 5px;
  padding:12px 24px;
  border:none;
  border-radius:999px;
  background:var(--accent);
  color:white;
  font-weight:600;
  cursor:pointer;
}

button:hover{background:var(--accent-hover);}

.resultBox{
  margin-top:25px;
  padding:15px;
  border-radius:18px;
  background:#fff6f9;
  border:1px solid var(--border);
}

.low{color:#2e7d32;}
.medium{color:#b26a00;}
.high{color:#b00020;}
</style>
</head>

<body>
<div class="wrapper">
<h1>Stress Level Detection AI</h1>

<div class="container">
<textarea id="inputText" placeholder="Type something or use voice..."></textarea>

<div>
<button onclick="predictText()">Analyze Text</button>
<button onclick="startVoice()">Analyze Voice</button>
<button onclick="clearAll()">Clear</button>
</div>

<div class="resultBox">
<div id="result">Predicted Stress Level: —</div>
<div id="confidence">Confidence: —</div>
</div>
</div>
</div>

<script>
let audioContext;
let analyser;
let microphone;
let dataArray;
let listening=false;

function startVoice(){
  if(listening) return;

  navigator.mediaDevices.getUserMedia({audio:true})
  .then(stream=>{
    audioContext=new (window.AudioContext||window.webkitAudioContext)();
    analyser=audioContext.createAnalyser();
    microphone=audioContext.createMediaStreamSource(stream);
    microphone.connect(analyser);
    analyser.fftSize=2048;

    const bufferLength=analyser.frequencyBinCount;
    dataArray=new Uint8Array(bufferLength);

    listening=true;
    analyzeVoice();
  })
  .catch(()=>{
    alert("Microphone access denied.");
  });
}

function analyzeVoice(){
  analyser.getByteFrequencyData(dataArray);

  let sum=0;
  for(let i=0;i<dataArray.length;i++){
    sum+=dataArray[i];
  }

  let averageVolume=sum/dataArray.length;

  let score=0;

  if(averageVolume>90) score+=8;
  else if(averageVolume>60) score+=4;
  else score+=1;

  renderResult(score);

  if(listening){
    requestAnimationFrame(analyzeVoice);
  }
}

function predictText(){
  const text=document.getElementById("inputText").value.toLowerCase();

  const highWords=["overwhelmed","panic","stressed","anxious","hate","can't","cant","help me"];
  const mediumWords=["nervous","tired","busy","upset"];
  const lowWords=["calm","relaxed","fine","okay","good"];

  let score=0;

  highWords.forEach(w=>{if(text.includes(w)) score+=6;});
  mediumWords.forEach(w=>{if(text.includes(w)) score+=3;});
  lowWords.forEach(w=>{if(text.includes(w)) score-=2;});

  renderResult(score);
}

function renderResult(score){
  let level="Low",cls="low";
  if(score>=8){level="High";cls="high";}
  else if(score>=4){level="Medium";cls="medium";}

  let confidence=Math.min(100,Math.round(50+Math.abs(score)*5));

  let result=document.getElementById("result");
  result.className=cls;
  result.textContent="Predicted Stress Level: "+level;

  document.getElementById("confidence").textContent="Confidence: "+confidence+"%";
}

function clearAll(){
  document.getElementById("inputText").value="";
  document.getElementById("result").textContent="Predicted Stress Level: —";
  document.getElementById("confidence").textContent="Confidence: —";
}
</script>

</body>
</html>
